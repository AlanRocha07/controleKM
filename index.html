<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="utf-8"/><title>Controle de Quilometragem</title></head>
<body>
<!-- ConteÃºdo do app aqui -->

<script>
// PWA install CTA
let deferredPrompt;
window.addEventListener('beforeinstallprompt',(e)=>{
  e.preventDefault();
  deferredPrompt = e;
  const b=document.createElement('button');
  b.textContent='ðŸ“² Instale o aplicativo';
  b.className='btn small';
  b.style.marginTop='10px';
  const c=document.querySelector('.container')||document.body;
  c.prepend(b);
  b.addEventListener('click',async()=>{
    b.remove();
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt=null;
  });
});

// Service worker
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker-v12.js').then(reg=>{
    if(reg.waiting){
        reg.waiting.postMessage({type:'SKIP_WAITING'});
    }
    reg.addEventListener('updatefound',()=>{
        const nw = reg.installing;
        nw?.addEventListener('statechange',()=>{
            if(nw.state==='installed' && navigator.serviceWorker.controller){
                // opcional: aÃ§Ã£o apÃ³s atualizaÃ§Ã£o
            }
        });
    });
    navigator.serviceWorker.addEventListener('controllerchange',()=>{});
  }).catch(()=>{});
}
</script>
</body>
</html>
